{"ast":null,"code":"import React from'react';import{Box,Typography,Button,Dialog,DialogTitle,DialogContent,DialogActions,Snackbar,Alert}from'@mui/material';import{useParams,useNavigate}from'react-router-dom';import{apiFetch}from'../../apiFetch';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function EliminarProducto(){const{id}=useParams();const navigate=useNavigate();const rol=localStorage.getItem('rol');const esAdmin=rol==='admin';const[producto,setProducto]=React.useState(null);const[confirmado,setConfirmado]=React.useState(false);const[eliminando,setEliminando]=React.useState(false);React.useEffect(()=>{const obtenerProducto=async()=>{try{const res=await apiFetch(`/api/productos/${id}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});if(!res.ok)throw new Error('No se encontrÃ³ el producto');const data=await res.json();setProducto(data);}catch(error){console.error('ðŸ”´ Error al obtener producto:',error);navigate('/');}};if(esAdmin)obtenerProducto();else navigate('/');},[id,esAdmin,navigate]);const handleEliminar=async()=>{setEliminando(true);try{const respuesta=await apiFetch(`/api/productos/${id}`,{method:'DELETE',headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});if(!respuesta.ok)throw new Error('Error al eliminar');const resultado=await respuesta.json();console.log(`âœ… Producto eliminado: ${(resultado===null||resultado===void 0?void 0:resultado.mensaje)||'sin mensaje'}`);setConfirmado(true);setTimeout(()=>navigate('/comprar'),2000);}catch(err){console.error('âŒ Error eliminando producto:',err);alert('No se pudo eliminar el producto. VerificÃ¡ credenciales o endpoint.');setEliminando(false);}};const handleCancelar=()=>navigate(-1);if(!producto)return null;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Dialog,{open:true,children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{fontWeight:'bold',color:'#d32f2f'},children:\"\\xBFDese\\xE1s eliminar este producto?\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsxs(Typography,{sx:{mb:2},children:[\"Esta acci\\xF3n eliminar\\xE1 el producto de forma \",/*#__PURE__*/_jsx(\"strong\",{children:\"permanente\"}),\".\"]}),/*#__PURE__*/_jsxs(Box,{sx:{p:2,bgcolor:'#f5f5f5',borderRadius:2},children:[/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nombre:\"}),\" \",producto.nombre]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",producto._id]}),/*#__PURE__*/_jsxs(Typography,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Precio:\"}),\" $\",producto.precio]}),/*#__PURE__*/_jsx(Typography,{sx:{mt:1,fontSize:'0.85rem',color:'#999'},children:\"(Esta acci\\xF3n no puede revertirse desde el panel de administraci\\xF3n)\"})]})]}),/*#__PURE__*/_jsxs(DialogActions,{sx:{justifyContent:'space-between',px:3,pb:2},children:[/*#__PURE__*/_jsx(Button,{onClick:handleCancelar,variant:\"outlined\",color:\"inherit\",sx:{textTransform:'none'},children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{onClick:handleEliminar,variant:\"contained\",color:\"error\",disabled:eliminando,sx:{fontWeight:'bold',textTransform:'none'},children:\"Eliminar permanentemente\"})]})]}),/*#__PURE__*/_jsx(Snackbar,{open:confirmado,autoHideDuration:4000,onClose:()=>setConfirmado(false),anchorOrigin:{vertical:'top',horizontal:'center'},children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",variant:\"filled\",sx:{bgcolor:'#1976d2',color:'white'},children:\"\\xA1Producto eliminado correctamente!\"})})]});}","map":{"version":3,"names":["React","Box","Typography","Button","Dialog","DialogTitle","DialogContent","DialogActions","Snackbar","Alert","useParams","useNavigate","apiFetch","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EliminarProducto","id","navigate","rol","localStorage","getItem","esAdmin","producto","setProducto","useState","confirmado","setConfirmado","eliminando","setEliminando","useEffect","obtenerProducto","res","headers","Authorization","ok","Error","data","json","error","console","handleEliminar","respuesta","method","resultado","log","mensaje","setTimeout","err","alert","handleCancelar","children","open","sx","fontWeight","color","mb","p","bgcolor","borderRadius","nombre","_id","precio","mt","fontSize","justifyContent","px","pb","onClick","variant","textTransform","disabled","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","severity"],"sources":["C:/MercadoAgricola-/frontend/src/components/forms/EliminarProducto.jsx"],"sourcesContent":["import React from 'react';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  Snackbar,\r\n  Alert\r\n} from '@mui/material';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { apiFetch } from '../../apiFetch';\r\n\r\nexport default function EliminarProducto() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const rol = localStorage.getItem('rol');\r\n  const esAdmin = rol === 'admin';\r\n\r\n  const [producto, setProducto] = React.useState(null);\r\n  const [confirmado, setConfirmado] = React.useState(false);\r\n  const [eliminando, setEliminando] = React.useState(false);\r\n\r\n  React.useEffect(() => {\r\n    const obtenerProducto = async () => {\r\n      try {\r\n        const res = await apiFetch(`/api/productos/${id}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`\r\n          }\r\n        });\r\n        if (!res.ok) throw new Error('No se encontrÃ³ el producto');\r\n        const data = await res.json();\r\n        setProducto(data);\r\n      } catch (error) {\r\n        console.error('ðŸ”´ Error al obtener producto:', error);\r\n        navigate('/');\r\n      }\r\n    };\r\n\r\n    if (esAdmin) obtenerProducto();\r\n    else navigate('/');\r\n  }, [id, esAdmin, navigate]);\r\n\r\n  const handleEliminar = async () => {\r\n    setEliminando(true);\r\n    try {\r\n      const respuesta = await apiFetch(`/api/productos/${id}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n\r\n      if (!respuesta.ok) throw new Error('Error al eliminar');\r\n      const resultado = await respuesta.json();\r\n      console.log(`âœ… Producto eliminado: ${resultado?.mensaje || 'sin mensaje'}`);\r\n      setConfirmado(true);\r\n      setTimeout(() => navigate('/comprar'), 2000);\r\n    } catch (err) {\r\n      console.error('âŒ Error eliminando producto:', err);\r\n      alert('No se pudo eliminar el producto. VerificÃ¡ credenciales o endpoint.');\r\n      setEliminando(false);\r\n    }\r\n  };\r\n\r\n  const handleCancelar = () => navigate(-1);\r\n\r\n  if (!producto) return null;\r\n\r\n  return (\r\n    <>\r\n      <Dialog open>\r\n        <DialogTitle sx={{ fontWeight: 'bold', color: '#d32f2f' }}>\r\n          Â¿DeseÃ¡s eliminar este producto?\r\n        </DialogTitle>\r\n\r\n        <DialogContent>\r\n          <Typography sx={{ mb: 2 }}>\r\n            Esta acciÃ³n eliminarÃ¡ el producto de forma <strong>permanente</strong>.\r\n          </Typography>\r\n\r\n          <Box sx={{ p: 2, bgcolor: '#f5f5f5', borderRadius: 2 }}>\r\n            <Typography><strong>Nombre:</strong> {producto.nombre}</Typography>\r\n            <Typography><strong>ID:</strong> {producto._id}</Typography>\r\n            <Typography><strong>Precio:</strong> ${producto.precio}</Typography>\r\n            <Typography sx={{ mt: 1, fontSize: '0.85rem', color: '#999' }}>\r\n              (Esta acciÃ³n no puede revertirse desde el panel de administraciÃ³n)\r\n            </Typography>\r\n          </Box>\r\n        </DialogContent>\r\n\r\n        <DialogActions sx={{ justifyContent: 'space-between', px: 3, pb: 2 }}>\r\n          <Button\r\n            onClick={handleCancelar}\r\n            variant=\"outlined\"\r\n            color=\"inherit\"\r\n            sx={{ textTransform: 'none' }}\r\n          >\r\n            Cancelar\r\n          </Button>\r\n\r\n          <Button\r\n            onClick={handleEliminar}\r\n            variant=\"contained\"\r\n            color=\"error\"\r\n            disabled={eliminando}\r\n            sx={{ fontWeight: 'bold', textTransform: 'none' }}\r\n          >\r\n            Eliminar permanentemente\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Snackbar\r\n        open={confirmado}\r\n        autoHideDuration={4000}\r\n        onClose={() => setConfirmado(false)}\r\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n      >\r\n        <Alert severity=\"success\" variant=\"filled\" sx={{ bgcolor: '#1976d2', color: 'white' }}>\r\n          Â¡Producto eliminado correctamente!\r\n        </Alert>\r\n      </Snackbar>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}